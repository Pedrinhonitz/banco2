ID,QUERY,TEMPO1,TEMPO2,TEMPO3
1,SELECT e.nome FROM dojo.public.empregados AS e INNER JOIN dojo.public.empregados AS e_ ON e.supervisor_id = e_.emp_id WHERE e.salario > e_.salario;,221ms,234ms,209ms
2,"SELECT d.dep_id, MAX(e.salario) FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id  GROUP BY 1 ORDER BY 1 ASC;",251ms,253ms,252ms
3,"WITH maior_salario AS (SELECT d.dep_id, MAX(e.salario) AS maior_salario FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id GROUP BY 1 ORDER BY 1 DESC) SELECT ms.dep_id, e.nome, ms.maior_salario FROM dojo.public.empregados AS e INNER JOIN maior_salario AS ms ON e.dep_id = ms.dep_id AND e.salario = ms.maior_salario;",266ms,254ms,264ms
4,"WITH quantidade_empregados AS (SELECT d.dep_id, COUNT(1) AS quantidade_empregados FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id GROUP BY 1) SELECT d.nome FROM dojo.public.departamentos AS d INNER JOIN quantidade_empregados AS qe ON d.dep_id = qe.dep_id WHERE qe.quantidade_empregados < 3 ORDER BY 1 ASC;",245ms,218ms,226ms
5,"SELECT d.nome, COUNT(1) AS quantidade_empregados FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id GROUP BY 1;",280ms,281ms,283ms
6,"WITH chefes AS (SELECT e.emp_id, e.dep_id, e.supervisor_id, e.nome, e.salario, d.dep_id AS id_departamento, d.nome AS nome_departamento FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id)SELECT ch.nome, ch.dep_id FROM chefes AS ch INNER JOIN chefes AS ch_ ON ch.supervisor_id = ch_.emp_id WHERE ch.nome_departamento != ch_.nome_departamento;",1.287s,1.242s,1.244s
7,"SELECT DISTINCT SUM(e.salario) OVER(PARTITION BY d.nome) AS soma, d.nome AS nome_departamento FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id ORDER BY 1 ASC;",1.747s,1.754s,1.762s
8,"WITH base AS (SELECT e.emp_id, e.dep_id, e.supervisor_id, e.nome, e.salario, d.dep_id AS id_departamento, d.nome AS nome_departamento, AVG(e.salario) OVER(PARTITION BY d.dep_id) AS media_departamento FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id) SELECT nome, salario FROM base WHERE salario > media_departamento;",392ms,385ms,392ms
9," SELECT e.dep_id, e.nome, e.salario, AVG(e.salario) OVER(PARTITION BY d.dep_id) AS media_departamento FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id;",362ms,364ms,377ms
10,"WITH base AS (SELECT e.nome, e.salario, d.dep_id, AVG(e.salario) OVER(PARTITION BY d.dep_id) AS media_departamento FROM dojo.public.empregados AS e INNER JOIN dojo.public.departamentos AS d ON e.dep_id = d.dep_id) SELECT * FROM base WHERE salario >= media_departamento;",386ms,394ms,405ms